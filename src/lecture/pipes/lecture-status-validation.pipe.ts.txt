import { ArgumentMetadata, NotFoundException, PipeTransform } from "@nestjs/common";
import * as lecture from "../lecture.model";

export class LectureStatusValidationPipe implements PipeTransform {

    transform(value: string, metadata: ArgumentMetadata) {
        value = value.toUpperCase();
        if (this.validateStatus(value)) {
            throw new NotFoundException('lecture\'s status should be "PUBLIC" or "PRIVATE".');
        }
        return value;
    }

    validateStatus(value: string): boolean {
        const regex = new RegExp(`${lecture.PRIVATE} | ${lecture.PUBLIC}`,'gi');
        return regex.test(value);
    }
}